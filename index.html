<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro Escolar</title>

  <style>
    body { font-family: Arial; background:#eef3f8; padding:20px;}
    input,button,textarea{font-size:17px;padding:10px;margin-bottom:10px;width:100%}
    li{background:#fff;margin:4px 0;padding:8px;border-radius:6px}
    .error{color:red}.success{color:green}
    .horario { background:#fff; padding:8px; border-radius:6px; margin-bottom:5px; }
    .actual { background:#d1f7c4; font-weight:bold; }
  </style>
</head>

<body>

<h1>üìò Registro Escolar</h1>

<!-- VALIDACI√ìN DE CORREO -->
<h2>‚úâ Correo institucional</h2>
<input type="email" id="emailInput" placeholder="tuemail@philips.edu.ar">
<button type="button" onclick="validarEmail()">Validar</button>
<p id="emailMensaje"></p>

<!-- FORMULARIO DE DATOS -->
<div id="datosForm" style="display:none;">
<h2>üë§ Datos del estudiante</h2>
<input type="text" id="nombreInput" placeholder="Nombre">
<input type="text" id="apellidoInput" placeholder="Apellido">
<button type="button" onclick="mostrarHorarios()">Continuar</button>
</div>

<!-- HORARIOS MOSTRADOS -->
<div id="horariosBox" style="display:none;">
  <h2>üìÖ Horarios del d√≠a</h2>
  <div id="horariosLista"></div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

<script>
/* üî• FIREBASE */
const firebaseConfig={ apiKey:"", authDomain:"", databaseURL:"", projectId:"", storageBucket:"", messagingSenderId:"", appId:"" };
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

/* Sanitizar ID */
function limpiarID(email){ return email.toLowerCase().replace(/[.#$[\]]/g,"_").replace(/\s+/g,"_"); }

let emailValidado = null;

/* VALIDAR */
function validarEmail(){
  const email=document.getElementById("emailInput").value.trim();
  const msg=document.getElementById("emailMensaje");

  if(!email.endsWith("@philips.edu.ar")){
    msg.textContent="Solo se permiten correos institucionales";
    msg.className="error";
    document.getElementById("datosForm").style.display="none";
    return;
  }

  msg.textContent="‚úî Correo v√°lido. Completa tu nombre y apellido.";
  msg.className="success";

  emailValidado = email;
  document.getElementById("datosForm").style.display="block";
}

/* HORARIOS CARGADOS DEL C√ìDIGO */
const horarios = {
  1: [
    { ini:465, fin:505, mat:"Geograf√≠a" },
    { ini:505, fin:595, mat:"Educaci√≥n Art√≠stica" },
    { ini:595, fin:725, mat:"Expresi√≥n Oral y Escrita" }
  ],
  2: [
    { ini:465, fin:545, mat:"Historia" },
    { ini:555, fin:675, mat:"Ingl√©s" },
    { ini:705, fin:735, mat:"Micro" },
    { ini:735, fin:855, mat:"Educaci√≥n F√≠sica" }
  ],
  3: [
    { ini:465, fin:635, mat:"Dibujo T√©cnico" },
    { ini:645, fin:685, mat:"Tutor√≠a" },
    { ini:685, fin:725, mat:"Educaci√≥n Art√≠stica" }
  ],
  4: [
    { ini:465, fin:545, mat:"Geograf√≠a" },
    { ini:555, fin:635, mat:"Matem√°tica" },
    { ini:645, fin:725, mat:"ABP" }
  ],
  5: [
    { ini:465, fin:545, mat:"Matem√°tica" },
    { ini:555, fin:635, mat:"Biolog√≠a" },
    { ini:645, fin:725, mat:"Programaci√≥n" }
  ]
};

/* MOSTRAR HORARIOS */
function mostrarHorarios(){
  const nombre = document.getElementById("nombreInput").value.trim();
  const apellido = document.getElementById("apellidoInput").value.trim();

  if(!nombre || !apellido){
    alert("Complet√° nombre y apellido.");
    return;
  }

  const hoy = new Date().getDay();
  const ahora = new Date();
  const minutos = ahora.getHours()*60 + ahora.getMinutes();

  const lista = document.getElementById("horariosLista");
  lista.innerHTML = "";

  if(!horarios[hoy]){
    lista.innerHTML = "<p>No hay horarios para hoy.</p>";
  } else {
    horarios[hoy].forEach(h => {
      const div = document.createElement("div");
      div.classList.add("horario");

      const esActual = minutos >= h.ini && minutos < h.fin;
      if(esActual) div.classList.add("actual");

      div.textContent = `${h.mat} ‚Äî ${minutosAHora(h.ini)} a ${minutosAHora(h.fin)} ${esActual ? "(AHORA)" : ""}`;
      lista.appendChild(div);
    });
  }

  document.getElementById("horariosBox").style.display="block";
}

/* CONVERSI√ìN MINUTOS ‚Üí FORMATO HH:MM */
function minutosAHora(m){
  const h = Math.floor(m/60).toString().padStart(2,"0");
  const min = (m%60).toString().padStart(2,"0");
  return `${h}:${min}`;
}
</script>

</body>
</html>
